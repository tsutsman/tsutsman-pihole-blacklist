# Критерії включення доменів і регулярних виразів

[English version](en/criteria.md)

Документ встановлює єдині правила, за якими домени та регулярні
вирази потрапляють до каталогу метаданих і продукційних списків.
Виконання критеріїв контролюється скриптом
`python scripts/validate_catalog.py`.

## Базові вимоги

1. **Обґрунтування загрози.** Для кожного запису в каталозі
   фіксується категорія, рівень загрози та щонайменше одне джерело,
   що підтверджує шкідливість домену або регулярного виразу.
2. **Прозорість походження.** Поле `added` містить дату у форматі
   ISO 8601, коли запис було додано до каталогу.
3. **Географічна актуальність.** Усі зазначені регіони мають належати
   до дозволеного переліку (`global`, `ru`, `cis` для доменів та
   `ru`, `by` для регулярних виразів).
4. **Статус та примітки.** Якщо статус запису відрізняється від
   `active`, потрібно заповнити пояснювальне поле `notes`.

## Політика включення

Файл `data/inclusion_policy.json` описує:

- перелік обов'язкових полів для доменів і регулярних виразів;
- допустимі значення для категорій, регіонів, статусів і рівнів загрози;
- мінімальну кількість джерел, що підтверджують кожен запис;
- додаткові умови (наприклад, вимогу наявності нотаток для неактивних
  записів).

Політику можна розширювати, додаючи нові категорії або додаткові
перевірки. Для цього достатньо змінити `inclusion_policy.json` та
оновити README, якщо правила суттєво відрізняються.

## Автоматична перевірка

Запуск скрипта `validate_catalog.py` перевіряє відповідність каталогу
політиці та повертає ненульовий код завершення у разі порушень.
Приклади запуску:

```bash
python scripts/validate_catalog.py
python scripts/validate_catalog.py --catalog альтернативний_каталог.json \
    --policy custom_policy.json
```

Результати можна інтегрувати у CI, щоб не допустити появи нових записів
без необхідних метаданих або з некоректними значеннями.
